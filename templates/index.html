{% extends 'base.html' %}

{% block title %}Home - NewsHub{% endblock %}

{% block content %}

<!-- Hero Section -->
<div class="py-5 mb-4 text-center text-white rounded"
     style="background: linear-gradient(135deg,#6b7cff,#8f7bff);">
  <div class="container-lg">
    <h1 class="display-6 fw-bold">Latest News Headlines</h1>
    <p class="lead mb-0">Stay updated with the latest news from trusted sources</p>
  </div>
</div>

<!-- Category Filters -->
<div class="d-flex flex-wrap gap-2 mb-4 justify-content-center">
  <a href="{{ url_for('index') }}"
     class="btn btn-sm {% if not current_category %}btn-primary{% else %}btn-outline-secondary{% endif %}">
     All
  </a>

  {% for cat in categories %}
    <a href="{{ url_for('index', category=cat.category_name) }}"
       class="btn btn-sm {% if current_category == cat.category_name %}btn-primary{% else %}btn-outline-secondary{% endif %}">
       {{ cat.category_name }}
    </a>
  {% endfor %}
</div>

<!-- News Grid -->
<div class="row g-4">
  {% for h in headlines %}
    <div class="col-12 col-md-6 col-lg-4 col-xl-3">
      <div class="card h-100 shadow-sm border-0 news-card">

        {% if h.image_url %}
          <div class="ratio ratio-16x9">
            <img src="{{ h.image_url }}"
                 class="card-img-top object-fit-cover"
                 alt="{{ h.title }}">
          </div>
        {% endif %}

        <div class="card-body d-flex flex-column">
          <h6 class="card-title">{{ h.title }}</h6>

          <div class="mb-2">
            <small class="text-muted">{{ h.source_name or 'Source' }} · {{ h.publish_date|timesince }}</small>
          </div>

          {% if h.description %}
            <p class="card-text small text-muted">
              {{ h.description }}
            </p>
          {% endif %}

          <div class="mt-auto d-flex justify-content-between align-items-center">
            <a href="{{ h.url }}" target="_blank" class="btn btn-sm btn-primary">Read More</a>
            {% if session.get('user_id') %}
              {% if h.headline_id|is_favorited %}
                <form method="post" action="{{ url_for('remove_favorite', headline_id=h.headline_id) }}">
                  <button class="btn btn-warning btn-sm" title="Remove from favorites">★</button>
                </form>
              {% else %}
                <form method="post" action="{{ url_for('add_favorite', headline_id=h.headline_id) }}">
                  <button class="btn btn-outline-danger btn-sm" title="Save to favorites">☆</button>
                </form>
              {% endif %}
            {% else %}
              <a href="{{ url_for('login') }}" class="btn btn-outline-secondary btn-sm" title="Login to save">☆</a>
            {% endif %}
          </div>
        </div>

      </div>
    </div>
  {% endfor %}
</div>

{% if total_pages and total_pages > 1 %}
  <nav class="mt-4">
    <ul class="pagination justify-content-center">
      {% if page > 1 %}
        <li class="page-item"><a class="page-link" href="{{ url_for('index', page=page-1, category=current_category) }}">Previous</a></li>
      {% endif %}

      {% for p in range(1, total_pages + 1) %}
        <li class="page-item {% if p == page %}active{% endif %}"><a class="page-link" href="{{ url_for('index', page=p, category=current_category) }}">{{ p }}</a></li>
      {% endfor %}

      {% if page < total_pages %}
        <li class="page-item"><a class="page-link" href="{{ url_for('index', page=page+1, category=current_category) }}">Next</a></li>
      {% endif %}
    </ul>
  </nav>
{% endif %}

{% if not headlines %}
  <p class="text-center text-muted mt-5">
    No news available for this category.
  </p>
{% endif %}

{% endblock %}
